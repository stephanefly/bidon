# trunks-simu

> Plateforme de conception aérodynamique

[![Black code style](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/ambv/black)

## General informations about this application

This is a Django application was generated by [DevLab (YOM) cookiecutter template](https://gitlab.sofa.snm.snecma/shared/safranae-django-project-cookiecutter). Please read :

- [official documentation](https://docs.djangoproject.com/en/3.2/)
- [Django-Styleguide](https://github.com/HackSoftware/Django-Styleguide)
- TwoScoopsOfDjango (Ask YOM for a copy of the book)
- DevLab YOM django style guide and python bests practices

_The front template used is : [AdminLTE](https://adminlte.io/)_

## Installation

### Prerequisites

* Install a PostgreSQL 11+ RDBMS by following [Install PostgreSQL](https://dev-recipes-dev.snm.snecma/how-to-guides/db/install_postgresql/).
* Install Python 3.9+ by following [Dev Recipes's guide](https://dev-recipes-dev.snm.snecma/how-to-guides/python/install_python_with_devkit/).

### Virtualenv

Create a new python virtual environment :

```powershell
python -m venv venv
```

Activate it :

```powershell
.\venv\Scripts\Activate.ps1
```

### Requirements

We use **pip-tools** to track requirements.

```powershell
pip install pip-tools
```

**Attention !**
If you get this error : `ERROR: Could not install packages due to an OSError: [WinError 5] Accès refusé`; re run the last command.

For the first installation of your project you have to compile the requirements.
If you need to add extra requirements, don't forget to add them in `pyproject.toml` 
and re compile the `requirements*.txt` files.

For requirements added in dev section :
```powershell
pip-compile --extra=dev
```

For requirements added in prod section :
```powershell
pip-compile --extra=prod --output-file=requirements-prod.txt
```

Synchronize your venv :

```powershell
pip-sync
```

### Install your app localy

```powershell
pip install -e .
```

### Settings

Set `DJANGO_SETTINGS_MODULE` value.

* PowerShell : `$env:DJANGO_SETTINGS_MODULE="config.settings.local"`
* Windows CMD : `set DJANGO_SETTINGS_MODULE=config.settings.local`
* In PyCharm : `Run` > `Edit UtilitaireConfiguration` > `Django Server` > `Environment variables` and add `DJANGO_SETTINGS_MODULE=config.settings.local`

### Environment variables

All secrets (secret_key, db user, db password, db_host, etc.) and environment variables 
should be stored in `.env` at the root of the project.

You can duplicate `.env.example`.

You can add your own project environment variables.

### Database

#### Create database

In powershell:

```powershell
createdb --owner=postgres --encoding=UTF-8 -U postgres trunks-simu
```

Run your first migration :

```powershell
python .\manage.py migrate
```

## Enjoy :)

```powershell
python .\manage.py runserver

Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
August 08, 2023 - 09:37:02
Django version 4.2.4, using settings 'config.settings.local'
Starting development server at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.
```

## Add an app

This template do not create Django app ! You have to add them.

Use the [cookiecutter](https://gitlab.sofa.snm.snecma/shared/safranae-django-app-cookiecutter) created for this :)

Go into the src/apps package and then run the following command :

```
cookiecutter git@gitlab.sofa.snm.snecma:shared/safranae-django-app-template.git
```

## Other informations

[Built with SafranAE Cookiecutter Django](https://gitlab.sofa.snm.snecma/shared/safranae-django-project-cookiecutter)
[Read the Django Style Guide](https://dev-recipes-dev.snm.snecma/best-practices/django-best-practices/)
